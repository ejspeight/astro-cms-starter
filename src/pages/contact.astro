---
/**
 * Contact Page â€” Heading, intro, body content, and contact details from site.ts.
 *
 * Decision: Netlify Forms integration is deferred to Phase 5 per the plan.
 * For now, this page shows contact info and the CMS body content.
 */

import BaseLayout from "../layouts/BaseLayout.astro";
import { getEntry, render } from "astro:content";
import { site } from "../config/site";

const page = await getEntry("pages", "contact");
if (!page) throw new Error("Missing content: src/content/pages/contact.md");

const { Content } = await render(page);
const { heading, intro, seo_description, og_image } = page.data;

const addr = site.contact.address;
const addressLine = `${addr.street}, ${addr.suburb}, ${addr.city} ${addr.postcode}`;
---

<BaseLayout
  title="Contact"
  description={seo_description || undefined}
  ogImage={og_image || undefined}
>
  <main class="flex-1">
    <!-- Page header -->
    <section class="bg-secondary text-text-light py-16 md:py-20 px-6">
      <div class="max-w-3xl mx-auto text-center">
        <h1 class="text-4xl md:text-5xl font-bold font-heading text-text-light">{heading}</h1>
        {intro && (
          <p class="mt-4 text-lg text-text-muted max-w-2xl mx-auto">{intro}</p>
        )}
      </div>
    </section>

    <section class="py-12 md:py-16 px-6">
      <div class="max-w-4xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-12">

        <!-- Body content -->
        <div class="prose prose-slate">
          <Content />
        </div>

        <!-- Contact details card -->
        <div class="bg-accent-muted rounded-lg border border-border p-6 space-y-6">
          <div>
            <h3 class="font-heading font-bold text-lg mb-2">Email</h3>
            <a href={`mailto:${site.contact.email}`} class="text-primary hover:text-primary-hover transition-colors">
              {site.contact.email}
            </a>
          </div>

          <div>
            <h3 class="font-heading font-bold text-lg mb-2">Phone</h3>
            <a href={`tel:${site.contact.phone.replace(/\s/g, "")}`} class="text-primary hover:text-primary-hover transition-colors">
              {site.contact.phone}
            </a>
          </div>

          <div>
            <h3 class="font-heading font-bold text-lg mb-2">Address</h3>
            <p class="text-text-body">{addressLine}</p>
          </div>

          <div>
            <h3 class="font-heading font-bold text-lg mb-2">Hours</h3>
            <dl class="text-sm text-text-body space-y-1">
              {Object.entries(site.hours).map(([day, hours]) => (
                <div class="flex justify-between">
                  <dt class="capitalize">{day}</dt>
                  <dd>{hours ?? "Closed"}</dd>
                </div>
              ))}
            </dl>
          </div>
        </div>

      </div>
    </section>
  </main>
</BaseLayout>
